/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

import type { FieldMap } from '@kbn/alerts-as-data-utils';

export const ecsFieldMap: FieldMap = {
  id: { type: 'keyword', required: true },
  name: { type: 'keyword', required: true },
  x_mitre_log_source_references: { type: 'nested', required: true, array: true },
  'x_mitre_log_source_references.x_mitre_data_component_ref': { type: 'keyword', required: true },
  'x_mitre_log_source_references.data_component_name': { type: 'keyword', required: true },
  'x_mitre_log_source_references.name': { type: 'keyword', required: true },
  'x_mitre_log_source_references.channel': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.name_field': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.name_value': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.channel_field': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.channel_value': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.status': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.confidence': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.notes': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.verified': { type: 'boolean', required: true },
};

export const resultsFieldMap: FieldMap = {
  id: { type: 'keyword', required: true },
  name: { type: 'keyword', required: true },
  x_mitre_log_source_references: { type: 'nested', required: true, array: true },
  'x_mitre_log_source_references.x_mitre_data_component_ref': { type: 'keyword', required: true },
  'x_mitre_log_source_references.data_component_name': { type: 'keyword', required: true },
  'x_mitre_log_source_references.name': { type: 'keyword', required: true },
  'x_mitre_log_source_references.channel': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.name_field': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.name_value': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.channel_field': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.channel_value': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.status': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.confidence': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.notes': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.verified': { type: 'boolean', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.next_execution': { type: 'date', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.quality_score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.details': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.details.base_score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.details.status_multiplier': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.details.confidence_multiplier': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.data_field_completeness.details.reason': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.details': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.details.last_doc_timestamp': { type: 'date', required: false },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.details.last_doc_ingested': { type: 'date', required: false },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.details.delta_seconds': { type: 'long', required: false },
  'x_mitre_log_source_references.mapping.ecs.scores.timeliness.details.reason': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.consistency': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.consistency.score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.consistency.details': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.consistency.details.reason': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.device_completeness': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.device_completeness.score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.device_completeness.details': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.device_completeness.details.coverage_percent': { type: 'integer', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.device_completeness.details.reason': { type: 'keyword', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.retention': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.retention.score': { type: 'float', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.retention.details': { type: 'object', required: true, array: false },
  'x_mitre_log_source_references.mapping.ecs.scores.retention.details.retention_percent': { type: 'integer', required: true },
  'x_mitre_log_source_references.mapping.ecs.scores.retention.details.reason': { type: 'keyword', required: true },
};
